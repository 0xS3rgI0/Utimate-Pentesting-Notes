## Scanning 

#### Ping sweep ```nmap -sn 10.11.1.1-254```

#### Standard scans ```nmap -sS -sV -O 10.11.1.5```

	-sT = connect scan; -sS = SYN/Stealth scan
	
	-sC runs default scripts

#### Deep scan ```nmap -v -p- -sT (or -sS) 10.11.1.5```

## Enumeration

#### Banner grabbing 

Netcat: ```netcat: nc 10.11.1.5 4445```

Telnet: ```telnet 10.10.10.10 port```

nmap: -sV/-A parameters

#### OS detection ```nmap -O 10.0.0.19```

#### SMB
  
   SMB1 – Windows 2000, XP and 2003
  
   SMB2 – Windows Vista SP1 and 2003
  
   SMB2.1 – Windows 7 and Windows 2008 R2
  
   SMB3 – Windows 8 and Windows 2012

SMB Netbios listens on ports 139, 445 & several UDP ports

```nmap -p 139,445 --script=smb* 10.11.1.75```

```nmap -p 139,445 --script=smb-enum-users 10.11.1.75```

```nmap -v -p 139,445 -oG smb.txt 10.11.1.1-245 –open```

Tools:

```Nbtscan -r 10.11.1.0/24```

```Enum4linux -a 10.11.1.227```

```rpcclient -U "" $targetip```

Smbclient is a tool for connecting to SMB, similar to FTP.  Misconfigured servers will enable connections without credentials.

```smbclient \\\\$ip\\$share```  

#### SMTP 

   ```nc -nvv $targetip 25```
   
   VRFY asks a server to verify an email address

   EXPN asks the server for the membership of a mailing list

   Both are executed after creating a connection with netcat on port 25

#### HTTP

   Check out the page in a web browser.  Is there a potentially vulnerable web application?  Is the page setup?

   Probe the server with Nikto

```nikto -host 10.11.1.5 -port 80```

Scan for open directories with Dirbuster

#### SNMP

```nmap -sU –open -p 161 10.11.1.1-254 -oG mega-snmp.txt```

```snmp-check $targetip```

```onexixtyone -c community $targetip```

snmpwalk
  
   Useful if community stringknown, usually “public”
  
   Enumerating entire tree  ```snmpwalk -c public -v1 10.11.1.219```

#### FTP

```
ftp 10.11.1.5
Username: anonymous
Password: anything
```

### NFS

```rcpinfo -p $targetip```

```showmount $targetip -a```

```mount $targetip:/sites/webdata ./testing```

## Nmap Scripting Engine (NSE) 
	
Scripts stored in: /usr/share/nmap/scripts

```locate *.nse | grep smb```

Using the scripts:

```nmap -p 139,445 --script=$scriptname $targetip```

The scripting parameter also accepts wildcards:

```nmap -p 139,445 --script=smb-vuln* $targetip```

```nmap -v -p 21 --script=ftp-anon.nse 10.11.1.1-254```

```nmap -v -p 139, 445 --script=smb-security-mode 10.11.1.236```
