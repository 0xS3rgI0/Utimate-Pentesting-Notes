## Port Scanning 

#### Ping sweep ```nmap -sn 10.11.1.1-254```

	-sn = disbale port scan, host discovery only
	
#### Standard scan ```nmap -A 10.11.1.5```

#### Deep scan ```nmap -p- -A 10.11.1.5```

#### UDP scan ```nmap -sU 10.11.1.5```

#### Important flags

	-sT = TCP connect scan
	
	-sS = TCP SYN scan
	
	-sU = UDP scan
	
	-sN = null scan (no flags sets, can sometimes assist with detecting open ports on firewalled systems)
	
	-sX = Xmas tree scan (FIN, PSH, URG flags on)
	
	-sC runs default scripts
	
	-sV attempts to identify the version of the service running on ports
	
	-O attempts OS detection using TCP/IP fingerprinting
	
	-A = includes -sC, -sV, -O
	
	-p- = scan all ports, not only top 1,000
	
	-Pn = skip host discovery and scan all addresses
	
	-T = enables timing options, from 0 to 5 with 0 being the slowest

## Enumeration

#### Banner grabbing 

Netcat: ```netcat: nc 10.11.1.5 4445```

Telnet: ```telnet 10.10.10.10 port```

#### FTP (21)

```
ftp 10.11.1.5
Username: anonymous
Password: anything
```
#### SSH (22)

Look for version info, attempt anonymous login

```ssh 10.10.10.5```

#### SMTP (25)

   ```nc -nvv $targetip 25```
   
   VRFY asks a server to verify an email address

   EXPN asks the server for the membership of a mailing list

   Both are executed after creating a connection with netcat on port 25

#### DNS (53)

Attempt zone transfer using either ```dig axfr @10.10.10.10 Domain.com``` or ```dnsrecon -d domain.com```

#### HTTP (80 and 443)

     Look for service versions, directories, source code, vulnerabilities  
  
   1. Check out the page in a web browser, manually enumerate the pages looking for information
   
   2. View the source of the available web pages, look for comments, etc.
   
   3. Scan with Nikto:  ```nikto -host 10.11.1.5```
   
   4. Scan for open directories with Dirbuster ("go faster, medium word list, applicable file extensions)
   
   	Microsoft IIS - .asp or .aspx; Apache - .php; other intersting files - .pdf, .doc, .xls, .xlsx, .ppt, .pptx
   
   5. View web traffic with a proxy (Burp or Zap)
   
Other possibilities:

- Scan SSL for vulnerabilities ```sslscan $RHOST```

#### RPC/NFS (111)

```nmap -sV -p 111 --script=rpcinfo $RHOST```

```rcpinfo -p $targetip```

```nmap -p 111 --script nfs* $RHOST```

```showmount $targetip -a```

```mount -t nfs -o vers=3 $RHOST:/SHARENAME /mnt```

#### SMB (139 and 445)
  
   SMB1 – Windows 2000, XP and 2003
  
   SMB2 – Windows Vista SP1 and 2003
  
   SMB2.1 – Windows 7 and Windows 2008 R2
  
   SMB3 – Windows 8 and Windows 2012

```nmap -p 139,445 --script=smb* 10.11.1.75```

```nmap --script=smb-enum* 10.11.1.227```

```nmap -p 139,445 --script=smb-enum-users 10.11.1.75```

```nmap -v -p 139,445 -oG smb.txt 10.11.1.1-245 –open```

```nmap --script smb-vuln* 10.10.10.40```

Tools:

```Nbtscan -r 10.11.1.0/24```

```enum4linux -a 10.11.1.227```

```rpcclient -U "" $targetip```

```smbclient -L \\\\$ip\\$share```

Metasploit

```scanner/smb/smb_version```

#### SNMP (161/udp)

```nmap -sU –open -p 161 10.11.1.1-254 -oG mega-snmp.txt```

```snmp-check $targetip```

```onexixtyone -c community $targetip```

snmpwalk
  
   Useful if community stringknown, usually “public”
  
   Enumerating entire tree  ```snmpwalk -c public -v1 10.11.1.219```

## Nmap Scripting Engine (NSE) 
	
Scripts stored in: /usr/share/nmap/scripts

```locate *.nse | grep smb```

Using the scripts:

Banner grabbing ```nmap --script banner 10.10.10.5```

Vulnerability scanning ```nmap --script vuln 10.10.10.5```

```nmap -p 139,445 --script=$scriptname $targetip```

The scripting parameter also accepts wildcards:

```nmap -p 139,445 --script=smb-vuln* $targetip```

```nmap -v -p 21 --script=ftp-anon.nse 10.11.1.1-254```

```nmap -v -p 139, 445 --script=smb-security-mode 10.11.1.236```
